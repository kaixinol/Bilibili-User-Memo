<div class="user-box">
  <div class="user-avatar-wrapper">
    <img :src="user.avatar" class="user-avatar" :alt="user.nickname" />
  </div>
  <div class="user-info-section">
    <div class="user-info-label">BilibiliID</div>
    <div
      class="user-id"
      x-data="{ copied: false }"
      x-init="$nextTick(() => { if($el.scrollWidth > $el.clientWidth) $el.classList.add('can-expand') })"
      x-effect="user.id; $nextTick(() => { $el.classList.toggle('can-expand', $el.scrollWidth > $el.clientWidth) })"
      x-text="copied ? '✅ 已复制' : user.id"
      @click="
    navigator.clipboard.writeText(String(user.id));
    copied = true;
    setTimeout(() => { copied = false }, 500);
  "
      :class="{ 'copied-status': copied }"
      :title="copied ? '' : '点击复制 ID'"
    ></div>
  </div>
  <div class="user-nickname-section" :title="user.nickname">
    <div class="user-info-label">昵称</div>
    <a
      :href="'https://space.bilibili.com/' + user.id"
      target="_blank"
      class="user-nickname-link"
      x-text="$store.userList.formatDisplayName(user)"
    ></a>
  </div>
  <div class="user-note-section" x-data="{ isEditing: false }">
    <div class="user-info-label">备注</div>
    <input
      :value="user.memo"
      :readonly="!isEditing"
      :class="{ 'editing': isEditing }"
      class="user-note-input"
      @click="isEditing = true"
      @blur="isEditing = false; $store.userList.updateUser(user.id, { memo: $el.value })"
      @keydown.enter="isEditing = false; $store.userList.updateUser(user.id, { memo: $el.value })"
      x-init="$watch('isEditing', value => value && $nextTick(() => $el.focus()))"
    />
  </div>
  <svg
    class="delete-btn"
    style="cursor: pointer; z-index: 10"
    @click="if(confirm('确定要删除吗？')) { $store.userList.removeUser(user.id) }"
    title="删除用户"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path d="M10 11v6" />
    <path d="M14 11v6" />
    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
    <path d="M3 6h18" />
    <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
  </svg>
</div>
